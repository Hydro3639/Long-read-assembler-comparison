coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=assembler), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=assembler, shape=platform), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
# scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
# scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=assembler, shape=platform), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
# scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
# scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=assembler), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
# scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
# scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(shape=platform), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
# scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
# scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=platform), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
# scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
# scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=platform)) +
# scale_shape_manual("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
# scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(x=assembler, y=identity_trans)) +
geom_sina(aes(colour=platform))
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform))
ggplot(midwest, aes(state, area)) + geom_point()
p <- ggplot(midwest, aes(state, popdensity)) +
scale_y_log10()
p + geom_sina()
p + geom_sina(aes(colour = inmetro))
cols <- midwest$popdensity > 10000
p + geom_sina(colour = cols + 1L)
cols <- midwest$popdensity > 10000
p + geom_sina(colour = cols)
ggplot(midwest, aes(state, popdensity)) +
geom_sina(aes(colour = inmetro)) +
scale_y_log10()
ggplot(midwest, aes(state, popdensity)) +
geom_sina(aes(colour = inmetro)) +
scale_y_log10()
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform))
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform))
View(random_junk_results)
View(random_junk_results)
View(midwest)
midwest
ggplot(midwest, aes(state, popdensity)) +
geom_sina(aes(colour = county)) +
scale_y_log10()
ggplot(midwest, aes(state, popdensity)) +
geom_sina(aes(colour = inmetro)) +
scale_y_log10()
View(real_chromosome_results)
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity) +
geom_sina(aes(colour=lowest_window_identity))
ggplot(real_chromosome_results, aes(assembler, identity_trans))
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=lowest_window_identity))
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform))
midwest$popdensity > 10000
cols <- midwest$popdensity > 10000
cols + 1L
p + geom_sina(colour = cols + 1L)
real_chromosome_results <- read_tsv("real_set_chromosome_results") %>% filter(contiguity > 0.0) %>% filter(assembler != "flye_v2.4.2_plasmids") %>% filter(assembler != "flye_v2.4.2_meta") %>% filter(assembler != "flye_v2.4.2_plasmids_meta")
real_chromosome_results$platform <- factor(real_chromosome_results$platform, levels = c("pacbio", "nanopore"))
real_chromosome_results$platform_int <- real_chromosome_results$platform == "nanopore"
real_chromosome_results <- read_tsv("real_set_chromosome_results") %>% filter(contiguity > 0.0) %>% filter(assembler != "flye_v2.4.2_plasmids") %>% filter(assembler != "flye_v2.4.2_meta") %>% filter(assembler != "flye_v2.4.2_plasmids_meta")
real_chromosome_results$platform <- factor(real_chromosome_results$platform, levels = c("pacbio", "nanopore"))
real_chromosome_results$platform_int <- real_chromosome_results$platform == "nanopore" + 1L
real_chromosome_results <- read_tsv("real_set_chromosome_results") %>% filter(contiguity > 0.0) %>% filter(assembler != "flye_v2.4.2_plasmids") %>% filter(assembler != "flye_v2.4.2_meta") %>% filter(assembler != "flye_v2.4.2_plasmids_meta")
real_chromosome_results$platform <- factor(real_chromosome_results$platform, levels = c("pacbio", "nanopore"))
real_chromosome_results$platform_int <- (real_chromosome_results$platform == "nanopore") + 1L
ggplot(midwest, aes(state, popdensity)) +
geom_sina(aes(colour = inmetro)) +
scale_y_log10()
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform))
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int))
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(shape=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
cols
cols + 1L
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$platform_int
as.numeric(real_chromosome_results$platform_int)
as.integer(real_chromosome_results$platform_int)
real_chromosome_results$platform_int <- as.integer(real_chromosome_results$platform_int)
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(shape=platform_int)) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=platform_int)) +
scale_shape_identity() +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(shape=platform_int)) +
scale_shape_identity() +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results <- read_tsv("real_set_chromosome_results") %>% filter(contiguity > 0.0) %>% filter(assembler != "flye_v2.4.2_plasmids") %>% filter(assembler != "flye_v2.4.2_meta") %>% filter(assembler != "flye_v2.4.2_plasmids_meta")
real_chromosome_results$platform <- factor(real_chromosome_results$platform, levels = c("pacbio", "nanopore"))
real_chromosome_results$platform_int <- (real_chromosome_results$platform == "nanopore") + 16L
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(shape=platform_int)) +
scale_shape_identity() +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(shape=platform_int)) +
scale_shape_identity() +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(real_chromosome_results, aes(assembler, identity_trans)) +
geom_sina(aes(colour=assembler, shape=platform_int)) +
scale_shape_identity() +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity() +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity() +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform", values = c("pacbio" = 16, "nanopore" = 17), labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform") +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform", labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform", labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5")) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform", labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
real_chromosome_results$identity_trans <- id_y_trans(real_chromosome_results$identity)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=identity_trans, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=1, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform", labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
coord_cartesian(ylim=c(9, 55)) +
scale_y_continuous(breaks = seq(10, 50, 10), minor_breaks = NULL) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Mean sequence identity", x=NULL, y="Qscore")
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=minutes, colour=assembler), scale="area", maxwidth=0.85, bw=0.12, size=1.75, alpha=0.75, stroke=0) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "flye_v2.4.2_plasmids" = "#998B00", "flye_v2.4.2_meta" = "#998B00", "flye_v2.4.2_plasmids_meta" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
scale_y_log10(breaks = c(1, 3, 10, 30, 100, 300, 1000, 3000), minor_breaks = NULL, limits = c(2.9, 1430)) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Assembly time", y="Time (minutes)", x=NULL)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=minutes, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=0.12, size=1.75, alpha=0.75, stroke=0) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "flye_v2.4.2_plasmids" = "#998B00", "flye_v2.4.2_meta" = "#998B00", "flye_v2.4.2_plasmids_meta" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
scale_y_log10(breaks = c(1, 3, 10, 30, 100, 300, 1000, 3000), minor_breaks = NULL, limits = c(2.9, 1430)) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Assembly time", y="Time (minutes)", x=NULL)
ggplot(data=real_chromosome_results) +
geom_sina(aes(x=assembler, y=minutes, colour=assembler, shape=platform_int), scale="area", maxwidth=0.85, bw=0.12, size=1.75, alpha=0.75, stroke=0) +
scale_shape_identity("Platform", labels=c("PacBio RSII", "ONT MinION")) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "flye_v2.4.2_plasmids" = "#998B00", "flye_v2.4.2_meta" = "#998B00", "flye_v2.4.2_plasmids_meta" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
scale_y_log10(breaks = c(1, 3, 10, 30, 100, 300, 1000, 3000), minor_breaks = NULL, limits = c(2.9, 1430)) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Assembly time", y="Time (minutes)", x=NULL)
nanopore_chromosome_results <- filter(real_chromosome_results, platform == "nanopore")
ggplot(data=nanopore_chromosome_results) +
geom_sina(aes(x=assembler, y=minutes, colour=assembler), scale="area", maxwidth=0.85, bw=0.15, size=2.75, alpha=0.75, stroke=0) +
scale_colour_manual(values = c("canu_v1.8" = "#AB3B33", "flye_v2.4.2" = "#998B00", "flye_v2.4.2_plasmids" = "#998B00", "flye_v2.4.2_meta" = "#998B00", "flye_v2.4.2_plasmids_meta" = "#998B00", "ra_07364a1" = "#009E43", "unicycler_v0.4.7" = "#006DC4", "wtdbg2_v2.4" = "#AC50B5"), guide=FALSE) +
scale_y_log10(breaks = c(1, 3, 10, 30, 100, 300, 1000, 3000), minor_breaks = NULL, limits = c(2.9, 1430)) +
scale_x_discrete(labels = gsub("_", " ", c("Canu\nv1.8", "Flye\nv2.4.2", "Ra\n07364a1", "Unicycler\nv0.4.7", "Wtdbg2\nv2.4"))) +
theme_bw() +
labs(title="Assembly time", y="Time (minutes)", x=NULL)
View(read_depth_results)
View(real_chromosome_results)
setwd("~/Programs/Long-read-assembler-comparison/results")
library(tidyverse)
library(scales)
library(tools)
library(gridExtra)
library(ggforce)
library(knitr)
library(plyr)
library(dplyr)
opts_chunk$set(dpi=300, fig.path='./plots/', echo=T, dev=c('png','pdf'), warning=FALSE, message=FALSE)
adapter_length_results <- read_tsv("adapter_length_results") %>% filter(contigs > 0)
chimera_results <- read_tsv("chimera_results") %>% filter(contigs > 0)
glitch_results <- read_tsv("glitch_results") %>% filter(contigs > 0)
read_depth_results <- read_tsv("read_depth_results") %>% filter(contigs > 0)
read_identity_results <- read_tsv("read_identity_results") %>% filter(contigs > 0)
read_length_results <- read_tsv("read_length_results") %>% filter(contigs > 0)
random_junk_results <- read_tsv("random_junk_results") %>% filter(contigs > 0)
glitch_levels <- read_tsv("glitch_levels")
sim_chromosome_results <- read_tsv("good_set_results") %>% filter(contiguity > 0.0)  # drop any that were total failures
real_chromosome_results <- read_tsv("real_set_chromosome_results") %>% filter(contiguity > 0.0) %>% filter(assembler != "flye_v2.4.2_plasmids") %>% filter(assembler != "flye_v2.4.2_meta") %>% filter(assembler != "flye_v2.4.2_plasmids_meta")
real_chromosome_results$platform <- factor(real_chromosome_results$platform, levels = c("pacbio", "nanopore"))
real_chromosome_results$platform_int <- (real_chromosome_results$platform == "nanopore") + 16L
sim_plasmid_results <- read_tsv("plasmid_results") %>% filter(name != 'chromosome') %>% filter(depth >= 1.0) %>% filter(depth <= 1000.0)
sim_plasmid_results_chromosome <- read_tsv("plasmid_results") %>% filter(name == 'chromosome')
real_plasmid_results <- read_tsv("real_set_all_replicon_results") %>% filter(name != "1") %>% filter(depth > 5.0)
sim_plasmid_results$type <- "simulated"
real_plasmid_results$type <- "real"
plasmid_results <- rbind(sim_plasmid_results, real_plasmid_results)
plasmid_results$shape <- paste(plasmid_results$type, plasmid_results$contig_match, sep = "_")
plasmid_results$shape <- factor(plasmid_results$shape, levels = c("simulated_FALSE", "simulated_TRUE", "real_FALSE", "real_TRUE"))
completed_chromosome_percentage <- function(results, assembler_name) {
chromosome_count <- nrow(filter(results, assembler == assembler_name))
completed_chromosome_count <- nrow(filter(results, assembler == assembler_name) %>% filter(contig_match == TRUE))
return(c(assembler_name, 100.0 * completed_chromosome_count / chromosome_count))
}
completed_chromosome_percentage(sim_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage <- function(results, assembler_name) {
chromosome_count <- nrow(filter(results, assembler == assembler_name))
completed_chromosome_count <- nrow(filter(results, assembler == assembler_name) %>% filter(contig_match == TRUE))
return(c(assembler_name, 100.0 * completed_chromosome_count / chromosome_count))
}
completed_chromosome_percentage(sim_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage(real_chromosome_results, "canu_v1.8")
completed_chromosome_percentage <- function(results, assembler_name) {
chromosome_count <- nrow(filter(results, assembler == assembler_name))
completed_chromosome_count <- nrow(filter(results, assembler == assembler_name) %>% filter(contig_match == TRUE))
return(c(assembler_name, 100.0 * completed_chromosome_count / chromosome_count))
}
completed_chromosome_percentage(sim_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage(real_chromosome_results, "canu_v1.8")
View(sim_chromosome_results)
View(sim_chromosome_results)
View(sim_plasmid_results_chromosome)
View(real_plasmid_results)
real_plasmid_results <- read_tsv("real_set_all_replicon_results") %>% filter(name != "1") %>% filter(depth > 5.0)
real_plasmid_results_chromosome <- read_tsv("real_set_all_replicon_results") %>% filter(name == "1")
View(real_plasmid_results_chromosome)
completed_chromosome_percentage <- function(results, assembler_name) {
chromosome_count <- nrow(filter(results, assembler == assembler_name))
completed_chromosome_count <- nrow(filter(results, assembler == assembler_name) %>% filter(contig_match == TRUE))
return(c(assembler_name, 100.0 * completed_chromosome_count / chromosome_count))
}
completed_chromosome_percentage(sim_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage(real_chromosome_results, "canu_v1.8")
completed_chromosome_percentage <- function(results, assembler_name) {
chromosome_count <- nrow(filter(results, assembler == assembler_name))
completed_chromosome_count <- nrow(filter(results, assembler == assembler_name) %>% filter(contig_match == TRUE))
return(c(assembler_name, 100.0 * completed_chromosome_count / chromosome_count))
}
completed_chromosome_percentage(sim_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage(real_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(real_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(real_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(real_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage <- function(results, assembler_name) {
chromosome_count <- nrow(filter(results, assembler == assembler_name))
completed_chromosome_count <- nrow(filter(results, assembler == assembler_name) %>% filter(contig_match == TRUE))
return(c(assembler_name, completed_chromosome_count, chromosome_count, 100.0 * completed_chromosome_count / chromosome_count))
}
completed_chromosome_percentage(sim_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(sim_plasmid_results_chromosome, "wtdbg2_v2.4")
completed_chromosome_percentage(real_plasmid_results_chromosome, "canu_v1.8")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2_plasmids")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2_meta")
completed_chromosome_percentage(real_plasmid_results_chromosome, "flye_v2.4.2_plasmids_meta")
completed_chromosome_percentage(real_plasmid_results_chromosome, "ra_07364a1")
completed_chromosome_percentage(real_plasmid_results_chromosome, "unicycler_v0.4.7")
completed_chromosome_percentage(real_plasmid_results_chromosome, "wtdbg2_v2.4")
View(sim_chromosome_results)
View(real_chromosome_results)
