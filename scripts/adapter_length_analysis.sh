#!/usr/bin/env bash

cd /projects/js66/individuals/ryan/Badread/assemblies

./assembly_stats.py > adapter_length_results
for i in 0000 0001 0003 0005 0007 0009 0012 0015 0018 0021 0024 0027 0031 0034 0038 0042 0046 0050 0054 0058 0063 0067 0071 0076 0080 0085 0090 0095 0099 0104 0109 0114 0120 0125 0130 0135 0141 0146 0152 0157 0163 0168 0174 0180 0186 0192 0197 0203 0209 0215 0221 0228 0234 0240 0246 0253 0259 0265 0272 0278 0285 0291 0298 0305 0311 0318 0325 0332 0339 0346 0352 0359 0366 0373 0381 0388 0395 0402 0409 0416 0424 0431 0438 0446 0453 0461 0468 0476 0483 0491 0499 0506 0514 0522 0529 0537 0545 0553 0561 0569 0577 0585 0593 0601 0609 0617 0625 0633 0641 0650 0658 0666 0674 0683 0691 0699 0708 0716 0725 0733 0742 0750 0759 0767 0776 0785 0793 0802 0811 0820 0828 0837 0846 0855 0864 0873 0882 0891 0900 0909 0918 0927 0936 0945 0954 0963 0972 0982 0991 1000; do
    r=../reads/adapter_lengths/"$i".fastq.gz
    echo $r
    for f in adapter_lengths/"$i"_*.fasta.gz; do
        >&2 echo "    "$f
        minimap2 -c -t 8 -r 10000 -g 10000 -x asm20 --eqx ref_tripled.fasta $f 2> /dev/null > "$f".paf
        ./assembly_stats.py $f $r "$f".paf 3565206 >> adapter_length_results
        rm "$f".paf
    done
done
