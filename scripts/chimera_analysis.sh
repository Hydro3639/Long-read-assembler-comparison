#!/usr/bin/env bash

cd /projects/js66/individuals/ryan/Badread/assemblies

./assembly_stats.py > chimera_results
for i in 00.000 00.125 00.250 00.375 00.500 00.625 00.750 00.875 01.000 01.125 01.250 01.375 01.500 01.625 01.750 01.875 02.000 02.125 02.250 02.375 02.500 02.625 02.750 02.875 03.000 03.125 03.250 03.375 03.500 03.625 03.750 03.875 04.000 04.125 04.250 04.375 04.500 04.625 04.750 04.875 05.000 05.125 05.250 05.375 05.500 05.625 05.750 05.875 06.000 06.125 06.250 06.375 06.500 06.625 06.750 06.875 07.000 07.125 07.250 07.375 07.500 07.625 07.750 07.875 08.000 08.125 08.250 08.375 08.500 08.625 08.750 08.875 09.000 09.125 09.250 09.375 09.500 09.625 09.750 09.875 10.000 10.125 10.250 10.375 10.500 10.625 10.750 10.875 11.000 11.125 11.250 11.375 11.500 11.625 11.750 11.875 12.000 12.125 12.250 12.375 12.500 12.625 12.750 12.875 13.000 13.125 13.250 13.375 13.500 13.625 13.750 13.875 14.000 14.125 14.250 14.375 14.500 14.625 14.750 14.875 15.000 15.125 15.250 15.375 15.500 15.625 15.750 15.875 16.000 16.125 16.250 16.375 16.500 16.625 16.750 16.875 17.000 17.125 17.250 17.375 17.500 17.625 17.750 17.875 18.000 18.125 18.250 18.375 18.500 18.625 18.750 18.875 19.000 19.125 19.250 19.375 19.500 19.625 19.750 19.875 20.000 20.125 20.250 20.375 20.500 20.625 20.750 20.875 21.000 21.125 21.250 21.375 21.500 21.625 21.750 21.875 22.000 22.125 22.250 22.375 22.500 22.625 22.750 22.875 23.000 23.125 23.250 23.375 23.500 23.625 23.750 23.875 24.000 24.125 24.250 24.375 24.500 24.625 24.750 24.875 25.000 25.250 25.500 25.750 26.000 26.250 26.500 26.750 27.000 27.250 27.500 27.750 28.000 28.250 28.500 28.750 29.000 29.250 29.500 29.750 30.000 30.250 30.500 30.750 31.000 31.250 31.500 31.750 32.000 32.250 32.500 32.750 33.000 33.250 33.500 33.750 34.000 34.250 34.500 34.750 35.000 35.250 35.500 35.750 36.000 36.250 36.500 36.750 37.000 37.250 37.500 37.750 38.000 38.250 38.500 38.750 39.000 39.250 39.500 39.750 40.000 40.250 40.500 40.750 41.000 41.250 41.500 41.750 42.000 42.250 42.500 42.750 43.000 43.250 43.500 43.750 44.000 44.250 44.500 44.750 45.000 45.250 45.500 45.750 46.000 46.250 46.500 46.750 47.000 47.250 47.500 47.750 48.000 48.250 48.500 48.750 49.000 49.250 49.500 49.750 50.000; do
    r=../reads/chimeras/"$i".fastq.gz
    echo $r
    for f in chimeras/"$i"_*.fasta.gz; do
        >&2 echo "    "$f
        minimap2 -c -t 8 -r 10000 -g 10000 -x asm20 --eqx ref_tripled.fasta $f 2> /dev/null > "$f".paf
        ./assembly_stats.py $f $r "$f".paf 3565206 >> chimera_results
        rm "$f".paf
    done
done
