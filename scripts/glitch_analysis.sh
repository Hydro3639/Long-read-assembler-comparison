#!/usr/bin/env bash

cd /projects/js66/individuals/ryan/Badread/assemblies

./assembly_stats.py > glitch_results
for i in 000100,100.0,100.0 000104,099.5,099.5 000107,099.0,099.0 000111,098.5,098.5 000115,098.0,098.0 000119,097.5,097.5 000123,097.0,097.0 000127,096.5,096.5 000132,096.0,096.0 000136,095.5,095.5 000141,095.0,095.0 000146,094.5,094.5 000151,094.0,094.0 000157,093.5,093.5 000162,093.0,093.0 000168,092.5,092.5 000174,092.0,092.0 000180,091.5,091.5 000186,091.0,091.0 000193,090.5,090.5 000200,090.0,090.0 000207,089.5,089.5 000214,089.0,089.0 000221,088.5,088.5 000229,088.0,088.0 000237,087.5,087.5 000245,087.0,087.0 000254,086.5,086.5 000263,086.0,086.0 000272,085.5,085.5 000282,085.0,085.0 000292,084.5,084.5 000302,084.0,084.0 000313,083.5,083.5 000324,083.0,083.0 000335,082.5,082.5 000347,082.0,082.0 000359,081.5,081.5 000372,081.0,081.0 000385,080.5,080.5 000398,080.0,080.0 000412,079.5,079.5 000427,079.0,079.0 000442,078.5,078.5 000457,078.0,078.0 000473,077.5,077.5 000490,077.0,077.0 000507,076.5,076.5 000525,076.0,076.0 000543,075.5,075.5 000562,075.0,075.0 000582,074.5,074.5 000603,074.0,074.0 000624,073.5,073.5 000646,073.0,073.0 000668,072.5,072.5 000692,072.0,072.0 000716,071.5,071.5 000741,071.0,071.0 000767,070.5,070.5 000794,070.0,070.0 000822,069.5,069.5 000851,069.0,069.0 000881,068.5,068.5 000912,068.0,068.0 000944,067.5,067.5 000977,067.0,067.0 001012,066.5,066.5 001047,066.0,066.0 001084,065.5,065.5 001122,065.0,065.0 001161,064.5,064.5 001202,064.0,064.0 001244,063.5,063.5 001288,063.0,063.0 001333,062.5,062.5 001380,062.0,062.0 001429,061.5,061.5 001479,061.0,061.0 001531,060.5,060.5 001585,060.0,060.0 001641,059.5,059.5 001698,059.0,059.0 001758,058.5,058.5 001820,058.0,058.0 001884,057.5,057.5 001950,057.0,057.0 002018,056.5,056.5 002089,056.0,056.0 002163,055.5,055.5 002239,055.0,055.0 002317,054.5,054.5 002399,054.0,054.0 002483,053.5,053.5 002570,053.0,053.0 002661,052.5,052.5 002754,052.0,052.0 002851,051.5,051.5 002951,051.0,051.0 003055,050.5,050.5 003162,050.0,050.0 003273,049.5,049.5 003388,049.0,049.0 003507,048.5,048.5 003631,048.0,048.0 003758,047.5,047.5 003890,047.0,047.0 004027,046.5,046.5 004169,046.0,046.0 004315,045.5,045.5 004467,045.0,045.0 004624,044.5,044.5 004786,044.0,044.0 004954,043.5,043.5 005128,043.0,043.0 005309,042.5,042.5 005495,042.0,042.0 005688,041.5,041.5 005888,041.0,041.0 006095,040.5,040.5 006309,040.0,040.0 006531,039.5,039.5 006761,039.0,039.0 006998,038.5,038.5 007244,038.0,038.0 007499,037.5,037.5 007762,037.0,037.0 008035,036.5,036.5 008317,036.0,036.0 008610,035.5,035.5 008912,035.0,035.0 009225,034.5,034.5 009550,034.0,034.0 009885,033.5,033.5 010233,033.0,033.0 010592,032.5,032.5 010965,032.0,032.0 011350,031.5,031.5 011749,031.0,031.0 012162,030.5,030.5 012589,030.0,030.0 013031,029.5,029.5 013489,029.0,029.0 013963,028.5,028.5 014454,028.0,028.0 014962,027.5,027.5 015488,027.0,027.0 016032,026.5,026.5 016596,026.0,026.0 017179,025.5,025.5 017782,025.0,025.0 018407,024.5,024.5 019054,024.0,024.0 019724,023.5,023.5 020417,023.0,023.0 021135,022.5,022.5 021877,022.0,022.0 022646,021.5,021.5 023442,021.0,021.0 024266,020.5,020.5 025119,020.0,020.0 026001,019.5,019.5 026915,019.0,019.0 027861,018.5,018.5 028840,018.0,018.0 029853,017.5,017.5 030903,017.0,017.0 031989,016.5,016.5 033113,016.0,016.0 034276,015.5,015.5 035481,015.0,015.0 036728,014.5,014.5 038019,014.0,014.0 039355,013.5,013.5 040738,013.0,013.0 042169,012.5,012.5 043651,012.0,012.0 045185,011.5,011.5 046773,011.0,011.0 048417,010.5,010.5 050118,010.0,010.0 051880,009.5,009.5 053703,009.0,009.0 055590,008.5,008.5 057544,008.0,008.0 059566,007.5,007.5 061659,007.0,007.0 063826,006.5,006.5 066069,006.0,006.0 068391,005.5,005.5 070794,005.0,005.0 073282,004.5,004.5 075858,004.0,004.0 078523,003.5,003.5 081283,003.0,003.0 084139,002.5,002.5 087096,002.0,002.0 090157,001.5,001.5 093325,001.0,001.0 100000,000.0,000.0; do
    r=../reads/glitches/"$i".fastq.gz
    echo $r
    for f in glitches/"$i"_*.fasta.gz; do
        >&2 echo "    "$f
        minimap2 -c -t 8 -r 10000 -g 10000 -x asm20 --eqx ref_tripled.fasta $f 2> /dev/null > "$f".paf
        ./assembly_stats.py $f $r "$f".paf 3565206 >> glitch_results
        rm "$f".paf
    done
done
