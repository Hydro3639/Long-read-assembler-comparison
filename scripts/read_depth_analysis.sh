#!/usr/bin/env bash

cd /projects/js66/individuals/ryan/Badread/assemblies

./assembly_stats.py > read_depth_results
for i in 000.5 001.0 001.5 002.0 002.5 003.0 003.5 004.0 004.5 005.0 005.5 006.0 006.5 007.0 007.5 008.0 008.5 009.0 009.5 010.0 010.5 011.0 011.5 012.0 012.5 013.0 013.5 014.0 014.5 015.0 015.5 016.0 016.5 017.0 017.5 018.0 018.5 019.0 019.5 020.0 020.5 021.0 021.5 022.0 022.5 023.0 023.5 024.0 024.5 025.0 025.5 026.0 026.5 027.0 027.5 028.0 028.5 029.0 029.5 030.0 030.5 031.0 031.5 032.0 032.5 033.0 033.5 034.0 034.5 035.0 035.5 036.0 036.5 037.0 037.5 038.0 038.5 039.0 039.5 040.0 040.5 041.0 041.5 042.0 042.5 043.0 043.5 044.0 044.5 045.0 045.5 046.0 046.5 047.0 047.5 048.0 048.5 049.0 049.5 050.0 050.5 051.0 051.5 052.0 052.5 053.0 053.5 054.0 054.5 055.0 055.5 056.0 056.5 057.0 057.5 058.0 058.5 059.0 059.5 060.0 060.5 061.0 061.5 062.0 062.5 063.0 063.5 064.0 064.5 065.0 065.5 066.0 066.5 067.0 067.5 068.0 068.5 069.0 069.5 070.0 070.5 071.0 071.5 072.0 072.5 073.0 073.5 074.0 074.5 075.0 075.5 076.0 076.5 077.0 077.5 078.0 078.5 079.0 079.5 080.0 080.5 081.0 081.5 082.0 082.5 083.0 083.5 084.0 084.5 085.0 085.5 086.0 086.5 087.0 087.5 088.0 088.5 089.0 089.5 090.0 090.5 091.0 091.5 092.0 092.5 093.0 093.5 094.0 094.5 095.0 095.5 096.0 096.5 097.0 097.5 098.0 098.5 099.0 099.5 100.0; do
    r=../reads/read_depth/"$i".fastq.gz
    echo $r
    for f in read_depth/"$i"_*.fasta.gz; do
        >&2 echo "    "$f
        minimap2 -c -t 8 -r 10000 -g 10000 -x asm20 --eqx ref_tripled.fasta $f 2> /dev/null > "$f".paf
        ./assembly_stats.py $f $r "$f".paf 3565206 >> read_depth_results
        rm "$f".paf
    done
done
