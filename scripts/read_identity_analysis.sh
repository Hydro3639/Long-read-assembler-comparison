#!/usr/bin/env bash

cd /projects/js66/individuals/ryan/Badread/assemblies

./assembly_stats.py > read_identity_results
for i in 60.00 60.25 60.50 60.75 61.00 61.25 61.50 61.75 62.00 62.25 62.50 62.75 63.00 63.25 63.50 63.75 64.00 64.25 64.50 64.75 65.00 65.25 65.50 65.75 66.00 66.25 66.50 66.75 67.00 67.25 67.50 67.75 68.00 68.25 68.50 68.75 69.00 69.25 69.50 69.75 70.00 70.25 70.50 70.75 71.00 71.25 71.50 71.75 72.00 72.25 72.50 72.75 73.00 73.25 73.50 73.75 74.00 74.25 74.50 74.75 75.00 75.25 75.50 75.75 76.00 76.25 76.50 76.75 77.00 77.25 77.50 77.75 78.00 78.25 78.50 78.75 79.00 79.25 79.50 79.75 80.00 80.25 80.50 80.75 81.00 81.25 81.50 81.75 82.00 82.25 82.50 82.75 83.00 83.25 83.50 83.75 84.00 84.25 84.50 84.75 85.00 85.25 85.50 85.75 86.00 86.25 86.50 86.75 87.00 87.25 87.50 87.75 88.00 88.25 88.50 88.75 89.00 89.25 89.50 89.75 90.00 90.25 90.50 90.75 91.00 91.25 91.50 91.75 92.00 92.25 92.50 92.75 93.00 93.25 93.50 93.75 94.00 94.25 94.50 94.75 95.00 95.25 95.50 95.75 96.00 96.25 96.50 96.75 97.00 97.25 97.50 97.75 98.00 98.25 98.50 98.75 99.00 99.25 99.50 99.75; do
    r=../reads/read_identity/"$i".fastq.gz
    echo $r
    for f in read_identity/"$i"_*.fasta.gz; do
        >&2 echo "    "$f
        minimap2 -c -t 8 -r 10000 -g 10000 -x asm20 --eqx ref_tripled.fasta $f 2> /dev/null > "$f".paf
        ./assembly_stats.py $f $r "$f".paf 3565206 >> read_identity_results
        rm "$f".paf
    done
done
